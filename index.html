<html>
    <head>
        <title>CardFoldr</title>
        <meta charset="utf-8" />

        <script src="./assets/pdf-js/pdf.mjs" type="module"></script>
        <script src="./assets/pdf-lib/pdf-lib.min.js"></script>
        <script src="./assets/cardfoldr.js" type="module"></script>
        
        <link rel="stylesheet" href="./assets/purecss/pure-min.css" />
        <link rel="stylesheet" href="./assets/font-awesome/css/fontawesome.min.css" />
        <link rel="stylesheet" href="./assets/font-awesome/css/solid.min.css" />
        <link rel="stylesheet" href="./assets/font-awesome/css/solid.min.css" />
        <link rel="stylesheet" href="./assets/cardfoldr.css" />
    </head>

    <body>
        <main class="container">

            <h1>CardFoldr</h1>

            <p>
                CardFoldr is a tool to help you convert a PDF of card grids (say, 3x3 cards per page, several 
                pages of fronts and one page of backs) into a PDF with card fronts and backs on the same page, 
                with a foldline down the middle for easy double sided alignment.
            </p>
            <p>
                The tool is designed to work with cards that are 9 to a page, but can be adjusted to work with other configurations.
            </p>
            <p>
                CardFoldr runs completely in your browser, nothing is uploaded to a server. You can also download
                and host it yourself if you prefer. The source code is available on <a href="https://github.com/foosel/cardfoldr">GitHub</a>.
            </p>

            <h2>Step 1: Select PDF</h2>

            <p>
                Select a PDF file with the cards you want to convert. The cards should be in the correct order and orientation.
                If you have a separate file with the card backs, you can select it as the background file.
            </p>

            <form id="form-step1" class="pure-form" onsubmit="return false">
                <fieldset>
                    <legend>Cards</legend>
                    <input type="file" id="file" accept=".pdf" />
                </fieldset>
                <fieldset>
                    <legend>Background (optional)</legend>
                    <input type="file" id="background" accept=".pdf" />
                </fieldset>
            </form>

            <h2>Step 2: Create Grid</h2>

            <p>
                Define the grid for the cards. The grid will be drawn on the cards in red to help you move it to the
                correct point. You can also define a cut margin which will be shown in blue.
            </p>

            <form id="form-step2" class="pure-form pure-form-aligned" onsubmit="return false">
                <fieldset>
                    <legend>Grid size</legend>

                    <div class="pure-control-group">
                        <label for="countX">Count X:</label>
                        <input type="number" id="countX" min="1" step="1" value="3" />
                        <span class="help">Number of cards in horizontal direction</span>
                    </div>

                    <div class="pure-control-group">
                        <label for="countY">Count Y:</label>
                        <input type="number" id="countY" min="1" step="1" value="3" />
                        <span class="help">Number of cards in vertical direction</span>
                    </div>
                </fieldset>

                <fieldset>
                    <legend>Card size & location</legend>

                    <div class="pure-control-group">
                        <label for="width">Card width:</label>
                        <input type="number" id="width" step="0.1" value="63" /> mm
                    </div>

                    <div class="pure-control-group">
                        <label for="height">Card height:</label>
                        <input type="number" id="height" step="0.1" value="88" /> mm
                    </div>

                    <div class="pure-control-group">
                        <label for="startX">Start X:</label>
                        <input type="number" id="startX" step="0.1" value="10" /> mm
                        <span class="help">Distance from the left edge of the page to the left edge of the first card</span>
                    </div>

                    <div class="pure-control-group">
                        <label for="startY">Start Y:</label>
                        <input type="number" id="startY" step="0.1" value="10" /> mm
                        <span class="help">Distance from the top edge of the page to the top edge of the first card</span>
                    </div>

                    <div class="pure-control-group">
                        <label for="marginX">Margin X:</label>
                        <input type="number" id="marginX" step="0.1" value="0" /> mm
                        <span class="help">Distance between individual cards in horizontal direction</span>
                    </div>

                    <div class="pure-control-group">
                        <label for="marginY">Margin Y:</label>
                        <input type="number" id="marginY" step="0.1" value="0" /> mm
                        <span class="help">Distance between individual cards in vertical direction</span>
                    </div>

                    <div class="pure-control-group">
                        <label for="cutMargin">Cut margin:</label>
                        <input type="number" id="cutMargin" min="0" step="0.1" value="0" /> mm
                        <span class="help">Distance from the edge of the card to the cut line</span>
                    </div>
                </fieldset>

                <fieldset>
                    <legend>Scale & pages</legend>

                    <div class="pure-control-group">
                        <label for="scale">Scale:</label>
                        <input type="number" id="scale" step="0.5" value="1" />
                    </div>

                    <div class="pure-control-group">
                        <label for="pageSelection">Pages:</label>
                        <input type="text" id="pageSelection" placeholder="all" />
                        <span class="help">Comma separated list of pages or ranges of all included pages</span>
                    </div>

                    <div class="pure-control-group">
                        <label for="pageSelection">Background pages (optional):</label>
                        <input type="text" id="backgroundPageSelection" placeholder="all" />
                        <span class="help">Comma separated list of pages or ranges of all included pages from the background file</span>
                    </div>
                </fieldset>

                <div class="pure-controls">
                    <button id="refresh" class="pure-button pure-button-primary"><i class="fa fa-refresh"></i> Refresh Grid</button>
                </div>
            </form>

            <div id="pdf">
                <div id="coordinates"></div>
                <div id="pages"><p><em>Once you've loaded a PDF file, it will be shown here</em></p></div>
                <div id="pages-back"></div>
            </div>

            <h2>Step 3: Extract Cards</h2>

            <form id="form-step3" class="pure-form pure-form-aligned" onsubmit="return false">
                <div class="pure-control-group">
                    <label for="backs">Backs:</label>
                    <select id="backs">
                        <option value="lastpage">Last page</option>
                        <option value="duplex">Duplex (right edge)</option>
                        <option value="duplex2">Duplex (bottom edge)</option>
                        <option value="file">Separate file (first page only)</option>
                        <option value="fileall">Separate file (all pages, count must match)</option>
                    </select>
                </div>

                <div class="pure-controls">
                    <button id="extractCards" class="pure-button pure-button-primary"><i class="fa fa-gear"></i> Extract Cards</button>
                </div>
            </form>

            <div id="cards">
                <p><em>Once you've extraced the cards, they will be shown here, front marked blue, backs marked red</em></p>
            </div>

            <p id="card-output"></p>

            <h2>Step 4: Generate PDF</h2>

            <form id="form-step4" class="pure-form pure-form-aligned" onsubmit="return false">
                <fieldset>
                    <legend>PDF settings</legend>
                    <div class="pure-control-group">
                        <label for="pageSize">Page size:</label>
                        <select id="pageSize">
                            <option value="A4">A4</option>
                            <option value="Letter">Letter</option>
                        </select>
                    </div>
                </fieldset>

                <fieldset>
                    <legend>Layout settings</legend>

                    <div class="pure-control-group">
                        <label for="printerMargin">Printer margin:</label>
                        <input type="number" id="printerMargin" min="0" step="0.1" value="5" /> mm
                    </div>

                    <div class="pure-control-group">
                        <label for="cardMargin">Card margin:</label>
                        <input type="number" id="cardMargin" min="0" step="0.1" value="2" /> mm
                        <span class="help">Distance between individual cards</span>
                    </div>

                    <div class="pure-control-group">
                        <label for="foldingMargin">Folding margin:</label>
                        <input type="number" id="foldingMargin" min="0" step="0.1" value="2" /> mm
                        <span class="help">Distance from the fold line to the edge of the card</span>
                    </div>

                    <div class="pure-control-group">
                        <label for="foldLine">Fold line:</label>
                        <select id="foldLine">
                            <option value="vertical">Vertical</option>
                            <!--option value="horizontal">Horizontal</option-->
                        </select>
                        <span class="help">Direction of the fold line, currently only verical is implemented</span>
                    </div>
                </fieldset>

                <div class="pure-controls">
                    <a id="generate" class="pure-button pure-button-primary">
                        <i class="fa fa-flag-checkered"></i> Generate PDF
                    </a>
                </div>
            </form>

            <p id="generate-output"></p>

            <div id="output">
                <em>Once you've generated the PDF, it will be shown here</em>
            </div>

        </main>

        <footer>
            <p>
                Created with ❤️ by <a href="https://foosel.net">Gina "foosel" Häußge</a>
            </p>
        </footer>
    </body>
</html>
